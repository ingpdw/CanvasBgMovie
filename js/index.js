!function(i){function t(o){if(e[o])return e[o].exports;var s=e[o]={exports:{},id:o,loaded:!1};return i[o].call(s.exports,s,s.exports,t),s.loaded=!0,s.exports}var e={};return t.m=i,t.c=e,t.p="",t(0)}([function(i,t,e){i.exports=e(1)},function(i,t,e){"use strict";function o(i){return i&&i.__esModule?i:{default:i}}var s=e(2),n=o(s);!function(){window.ui||(window.ui={}),window.CanvasBgMovie||(window.CanvasBgMovie=n.default)}()},function(i,t){"use strict";function e(i,t){if(!(i instanceof t))throw new TypeError("Cannot call a class as a function")}var o=function(){function i(i,t){for(var e=0;e<t.length;e++){var o=t[e];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(i,o.key,o)}}return function(t,e,o){return e&&i(t.prototype,e),o&&i(t,o),t}}(),s=function(){function i(t,o){e(this,i),this.$parent=t,this.options={framesPerSecond:25,hideVideo:!0,autoplay:!0,loop:!0,fixedTop:!1,movieWidth:960,movieHeight:540,movieUrl:"",poster:"",endedCallback:""},jQuery.extend(!0,this.options,o),this.videoNode=jQuery(this.tmplVideo()),this.canvasNode=jQuery(this.tmplCanvas()),this.$parent.append(this.videoNode),this.video=this.videoNode.get(0),this.$parent.append(this.canvasNode),this.canvas=this.canvasNode.get(0),this.ctx=this.canvas.getContext("2d"),this.playing=!1,this.resizeTimeoutReference=!1,this.resizeTimout=100,this.init(),this.bind(),this.isIOS()||this.canvasNode.hide()}return o(i,[{key:"isIOS",value:function(){return/iPad|iPhone|iPod/.test(navigator.platform)}},{key:"position",value:function(){var i=this.width,t=this.height,e=jQuery(window).width(),o=jQuery(window).height(),s=-(i-e)/2,n=-(t-o)/2;this.options.fixedTop&&(n=0),this.isIOS()?this.canvasNode.css({position:"absolute",left:s,top:n}):this.videoNode.css({position:"absolute",left:s,top:n})}},{key:"load",value:function(){this.video.load()}},{key:"setLoop",value:function(i){i?this.videoNode.prop("loop","true"):this.videoNode.prop("loop",null)}},{key:"changeMovie",value:function(i){i&&(this.options.movieUrl=i,this.videoNode.find("source").attr("src",i))}},{key:"init",value:function(){this.video.load(),this.setCanvasSize(),this.position(),this.isIOS()&&this.options.hideVideo&&this.videoNode.hide()}},{key:"bind",value:function(){var i=this;this.isIOS()&&(this.video.addEventListener("timeupdate",function(){i.drawFrame()}),this.video.addEventListener("canplay",function(){i.drawFrame()}),this.video.readyState>=2&&this.drawFrame()),this.video.addEventListener("ended",function(){i.options.endCallback&&i.options.endCallback()}),this.isIOS()&&this.options.autoplay&&this.play(),jQuery(window).on("resize",function(){i.setCanvasSize(),i.position(),i.isIOS()&&i.drawFrame()}),jQuery(document).bind("webkitvisibilitychange",function(){window._checkVisibilityChange&&(document.webkitHidden?this.pause():this.play())})}},{key:"setCanvasSize",value:function(){var i=this.options.movieWidth,t=this.options.movieHeight,e=jQuery(window).width(),o=jQuery(window).height();this.height=Math.ceil(o),this.width=Math.ceil(this.height*i/t),this.width<e&&(this.height=Math.ceil(o+9*(e-this.width)/16),this.width=Math.ceil(this.height*i/t)),this.isIOS()?(this.ctx.canvas.width=this.width,this.ctx.canvas.height=this.height,this.canvasNode.attr("width",this.width),this.canvasNode.attr("height",this.height)):(this.videoNode.width(this.width),this.videoNode.height(this.height))}},{key:"play",value:function(){if(this.isIOS())this.lastTime=Date.now(),this.playing=!0,this.loop();else{this.playing=!0;try{this.videoNode.get(0).play()}catch(i){}}}},{key:"pause",value:function(){if(this.isIOS())this.playing=!1;else{this.playing=!1;try{this.videoNode.get(0).pause()}catch(i){}}}},{key:"playPause",value:function(){this.playing?this.pause():this.play()}},{key:"loop",value:function(){var i=this,t=Date.now(),e=(t-this.lastTime)/1e3;e>=1/this.options.framesPerSecond&&(this.video.currentTime=this.video.currentTime+e,this.lastTime=t),this.video.currentTime>=this.video.duration&&(this.playing=!1,this.options.loop===!0&&(this.video.currentTime=0,this.play())),this.playing?this.animationFrame=requestAnimationFrame(function(){i.loop()}):cancelAnimationFrame(this.animationFrame)}},{key:"tmplVideo",value:function(){var i="";return this.options.loop&&(i='loop="true" '),'<video class="video" muted="true" '+i+'autoplay="true" poster="'+this.options.poster+'">\n\t\t\t<source src="'+this.options.movieUrl+'" type="video/mp4"></video>'}},{key:"tmplCanvas",value:function(){return'<canvas class="canvas"></canvas>'}},{key:"drawFrame",value:function(){this.ctx.drawImage(this.video,0,0,this.width,this.height)}}]),i}();i.exports=s}]);
//# sourceMappingURL=index.js.map