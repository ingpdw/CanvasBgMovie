{"version":3,"sources":["webpack:///index.js","webpack:///webpack/bootstrap 3e6fed9b80dab8699286","webpack:///./js/App.js","webpack:///./js/Movie.js"],"names":["modules","__webpack_require__","moduleId","installedModules","exports","module","id","loaded","call","m","c","p","_interopRequireDefault","obj","__esModule","default","_Movie","_Movie2","window","ui","CanvasBgMovie","_classCallCheck","instance","Constructor","TypeError","_createClass","defineProperties","target","props","i","length","descriptor","enumerable","configurable","writable","Object","defineProperty","key","protoProps","staticProps","prototype","Movie","$parent","options","this","framesPerSecond","hideVideo","autoplay","loop","fixedTop","movieWidth","movieHeight","movieUrl","poster","endedCallback","jQuery","extend","videoNode","tmplVideo","canvasNode","tmplCanvas","append","video","get","canvas","ctx","getContext","playing","resizeTimeoutReference","resizeTimout","init","bind","isIOS","hide","value","test","navigator","platform","width","height","winWidth","winHeight","left","top","css","position","load","bool","prop","find","attr","setCanvasSize","_this","addEventListener","drawFrame","readyState","endCallback","play","on","document","_checkVisibilityChange","pause","Math","ceil","lastTime","Date","now","e","_this2","time","elapsed","currentTime","duration","animationFrame","requestAnimationFrame","cancelAnimationFrame","drawImage"],"mappings":"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","file":"index.js","sourcesContent":["/******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId])\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\texports: {},\n/******/ \t\t\tid: moduleId,\n/******/ \t\t\tloaded: false\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.loaded = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(0);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ function(module, exports, __webpack_require__) {\n\n\tmodule.exports = __webpack_require__(1);\n\n\n/***/ },\n/* 1 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t'use strict';\n\t\n\tvar _Movie = __webpack_require__(2);\n\t\n\tvar _Movie2 = _interopRequireDefault(_Movie);\n\t\n\tfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\t\n\t(function () {\n\t  'use strict';\n\t\n\t  if (!window.ui) window.ui = {};\n\t\n\t  if (!window.CanvasBgMovie) window.CanvasBgMovie = _Movie2.default;\n\t})();\n\n/***/ },\n/* 2 */\n/***/ function(module, exports) {\n\n\t'use strict';\n\t\n\tvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\t\n\tfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\t\n\tvar Movie = function () {\n\t\tfunction Movie($parent, options) {\n\t\t\t_classCallCheck(this, Movie);\n\t\n\t\t\tthis.$parent = $parent;\n\t\n\t\t\tthis.options = {\n\t\t\t\tframesPerSecond: 25,\n\t\t\t\thideVideo: true,\n\t\t\t\tautoplay: true,\n\t\t\t\tloop: true,\n\t\t\t\tfixedTop: false,\n\t\t\t\tmovieWidth: 960,\n\t\t\t\tmovieHeight: 540,\n\t\t\t\tmovieUrl: '',\n\t\t\t\tposter: '',\n\t\t\t\tendedCallback: ''\n\t\t\t};\n\t\n\t\t\tjQuery.extend(true, this.options, options);\n\t\n\t\t\tthis.videoNode = jQuery(this.tmplVideo());\n\t\t\tthis.canvasNode = jQuery(this.tmplCanvas());\n\t\n\t\t\tthis.$parent.append(this.videoNode);\n\t\t\tthis.video = this.videoNode.get(0);\n\t\n\t\t\tthis.$parent.append(this.canvasNode);\n\t\t\tthis.canvas = this.canvasNode.get(0);\n\t\n\t\t\tthis.ctx = this.canvas.getContext('2d');\n\t\n\t\t\tthis.playing = false;\n\t\t\tthis.resizeTimeoutReference = false;\n\t\t\tthis.resizeTimout = 100;\n\t\n\t\t\tthis.init();\n\t\t\tthis.bind();\n\t\n\t\t\tif (!this.isIOS()) {\n\t\t\t\tthis.canvasNode.hide();\n\t\t\t}\n\t\t}\n\t\n\t\t_createClass(Movie, [{\n\t\t\tkey: 'isIOS',\n\t\t\tvalue: function isIOS() {\n\t\t\t\treturn (/iPad|iPhone|iPod/.test(navigator.platform)\n\t\t\t\t);\n\t\t\t}\n\t\t}, {\n\t\t\tkey: 'position',\n\t\t\tvalue: function position() {\n\t\t\t\tvar movieWidth = this.width;\n\t\t\t\tvar movieHeight = this.height;\n\t\t\t\tvar winWidth = jQuery(window).width();\n\t\t\t\tvar winHeight = jQuery(window).height();\n\t\n\t\t\t\tvar left = -(movieWidth - winWidth) / 2;\n\t\t\t\tvar top = -(movieHeight - winHeight) / 2;\n\t\n\t\t\t\tif (this.options.fixedTop) {\n\t\t\t\t\ttop = 0;\n\t\t\t\t}\n\t\n\t\t\t\tif (this.isIOS()) {\n\t\t\t\t\tthis.canvasNode.css({ position: 'absolute', left: left, top: top });\n\t\t\t\t} else {\n\t\t\t\t\tthis.videoNode.css({ position: 'absolute', left: left, top: top });\n\t\t\t\t}\n\t\t\t}\n\t\t}, {\n\t\t\tkey: 'load',\n\t\t\tvalue: function load() {\n\t\t\t\tthis.video.load();\n\t\t\t}\n\t\t}, {\n\t\t\tkey: 'setLoop',\n\t\t\tvalue: function setLoop(bool) {\n\t\t\t\tbool ? this.videoNode.prop('loop', 'true') : this.videoNode.prop('loop', null);\n\t\t\t}\n\t\t}, {\n\t\t\tkey: 'changeMovie',\n\t\t\tvalue: function changeMovie(movieUrl) {\n\t\t\t\tif (!movieUrl) return;\n\t\n\t\t\t\tthis.options.movieUrl = movieUrl;\n\t\t\t\tthis.videoNode.find('source').attr('src', movieUrl);\n\t\t\t}\n\t\t}, {\n\t\t\tkey: 'init',\n\t\t\tvalue: function init() {\n\t\t\t\tthis.video.load();\n\t\t\t\tthis.setCanvasSize();\n\t\t\t\tthis.position();\n\t\n\t\t\t\tif (this.isIOS() && this.options.hideVideo) this.videoNode.hide();\n\t\t\t}\n\t\t}, {\n\t\t\tkey: 'bind',\n\t\t\tvalue: function bind() {\n\t\t\t\tvar _this = this;\n\t\n\t\t\t\tif (this.isIOS()) {\n\t\t\t\t\tthis.video.addEventListener('timeupdate', function () {\n\t\t\t\t\t\t_this.drawFrame();\n\t\t\t\t\t});\n\t\n\t\t\t\t\tthis.video.addEventListener('canplay', function () {\n\t\t\t\t\t\t_this.drawFrame();\n\t\t\t\t\t});\n\t\n\t\t\t\t\tif (this.video.readyState >= 2) {\n\t\t\t\t\t\tthis.drawFrame();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\n\t\t\t\tthis.video.addEventListener('ended', function () {\n\t\t\t\t\t_this.options.endCallback && _this.options.endCallback();\n\t\t\t\t});\n\t\n\t\t\t\tif (this.isIOS() && this.options.autoplay) {\n\t\t\t\t\tthis.play();\n\t\t\t\t}\n\t\n\t\t\t\t// Cache canvas size on resize (doing it only once in a second)\n\t\t\t\tjQuery(window).on('resize', function () {\n\t\t\t\t\t//clearTimeout( this.resizeTimeoutReference );\n\t\n\t\t\t\t\t//this.resizeTimeoutReference = setTimeout(() => {\n\t\t\t\t\t_this.setCanvasSize();\n\t\t\t\t\t_this.position();\n\t\n\t\t\t\t\tif (_this.isIOS()) _this.drawFrame();\n\t\t\t\t\t//}, this.resizeTimout );\n\t\t\t\t});\n\t\n\t\t\t\tjQuery(document).bind('webkitvisibilitychange', function () {\n\t\n\t\t\t\t\tif (!window._checkVisibilityChange) return;\n\t\n\t\t\t\t\tif (document['webkitHidden']) {\n\t\t\t\t\t\tthis.pause();\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis.play();\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t}, {\n\t\t\tkey: 'setCanvasSize',\n\t\t\tvalue: function setCanvasSize() {\n\t\t\t\tvar movieWidth = this.options.movieWidth;\n\t\t\t\tvar movieHeight = this.options.movieHeight;\n\t\t\t\tvar winWidth = jQuery(window).width();\n\t\t\t\tvar winHeight = jQuery(window).height();\n\t\n\t\t\t\tthis.height = Math.ceil(winHeight);\n\t\t\t\tthis.width = Math.ceil(this.height * movieWidth / movieHeight);\n\t\n\t\t\t\tif (this.width < winWidth) {\n\t\t\t\t\tthis.height = Math.ceil(winHeight + (winWidth - this.width) * 9 / 16);\n\t\t\t\t\tthis.width = Math.ceil(this.height * movieWidth / movieHeight);\n\t\t\t\t}\n\t\n\t\t\t\tif (this.isIOS()) {\n\t\t\t\t\tthis.ctx.canvas.width = this.width;\n\t\t\t\t\tthis.ctx.canvas.height = this.height;\n\t\n\t\t\t\t\tthis.canvasNode.attr('width', this.width);\n\t\t\t\t\tthis.canvasNode.attr('height', this.height);\n\t\t\t\t} else {\n\t\t\t\t\tthis.videoNode.width(this.width);\n\t\t\t\t\tthis.videoNode.height(this.height);\n\t\t\t\t}\n\t\t\t}\n\t\t}, {\n\t\t\tkey: 'play',\n\t\t\tvalue: function play() {\n\t\t\t\tif (this.isIOS()) {\n\t\t\t\t\tthis.lastTime = Date.now();\n\t\t\t\t\tthis.playing = true;\n\t\t\t\t\tthis.loop();\n\t\t\t\t} else {\n\t\t\t\t\tthis.playing = true;\n\t\n\t\t\t\t\t//TODO DOMException: The play() request was interrupted by a call to pause().\n\t\t\t\t\ttry {\n\t\t\t\t\t\tthis.videoNode.get(0).play();\n\t\t\t\t\t} catch (e) {}\n\t\t\t\t}\n\t\t\t}\n\t\t}, {\n\t\t\tkey: 'pause',\n\t\t\tvalue: function pause() {\n\t\t\t\tif (this.isIOS()) {\n\t\t\t\t\tthis.playing = false;\n\t\t\t\t} else {\n\t\t\t\t\tthis.playing = false;\n\t\t\t\t\t//TODO DOMException: The play() request was interrupted by a call to pause().\n\t\t\t\t\ttry {\n\t\t\t\t\t\tthis.videoNode.get(0).pause();\n\t\t\t\t\t} catch (e) {}\n\t\t\t\t}\n\t\t\t}\n\t\t}, {\n\t\t\tkey: 'playPause',\n\t\t\tvalue: function playPause() {\n\t\t\t\tif (this.playing) {\n\t\t\t\t\tthis.pause();\n\t\t\t\t} else {\n\t\t\t\t\tthis.play();\n\t\t\t\t}\n\t\t\t}\n\t\t}, {\n\t\t\tkey: 'loop',\n\t\t\tvalue: function loop() {\n\t\t\t\tvar _this2 = this;\n\t\n\t\t\t\tvar time = Date.now();\n\t\t\t\tvar elapsed = (time - this.lastTime) / 1000;\n\t\n\t\t\t\t// Render\n\t\t\t\tif (elapsed >= 1 / this.options.framesPerSecond) {\n\t\t\t\t\tthis.video.currentTime = this.video.currentTime + elapsed;\n\t\t\t\t\tthis.lastTime = time;\n\t\t\t\t}\n\t\n\t\t\t\tif (this.video.currentTime >= this.video.duration) {\n\t\t\t\t\tthis.playing = false;\n\t\n\t\t\t\t\tif (this.options.loop === true) {\n\t\t\t\t\t\tthis.video.currentTime = 0;\n\t\t\t\t\t\tthis.play();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\n\t\t\t\tif (this.playing) {\n\t\t\t\t\tthis.animationFrame = requestAnimationFrame(function () {\n\t\t\t\t\t\t_this2.loop();\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\tcancelAnimationFrame(this.animationFrame);\n\t\t\t\t}\n\t\t\t}\n\t\t}, {\n\t\t\tkey: 'tmplVideo',\n\t\t\tvalue: function tmplVideo() {\n\t\t\t\tvar loop = '';\n\t\n\t\t\t\tif (this.options.loop) loop = 'loop=\"true\" ';\n\t\n\t\t\t\treturn '<video class=\"video\" muted=\"true\" ' + loop + 'autoplay=\"true\" poster=\"' + this.options.poster + '\">\\n\\t\\t\\t<source src=\"' + this.options.movieUrl + '\" type=\"video/mp4\"></video>';\n\t\t\t}\n\t\t}, {\n\t\t\tkey: 'tmplCanvas',\n\t\t\tvalue: function tmplCanvas() {\n\t\t\t\treturn '<canvas class=\"canvas\"></canvas>';\n\t\t\t}\n\t\t}, {\n\t\t\tkey: 'drawFrame',\n\t\t\tvalue: function drawFrame() {\n\t\t\t\tthis.ctx.drawImage(this.video, 0, 0, this.width, this.height);\n\t\t\t}\n\t\t}]);\n\t\n\t\treturn Movie;\n\t}();\n\t\n\tmodule.exports = Movie;\n\n/***/ }\n/******/ ]);\n\n\n// WEBPACK FOOTER //\n// index.js"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 3e6fed9b80dab8699286","import Movie from './Movie.js';\n\n( function() {\n  'use strict';\n\n  if( !window.ui )\n    window.ui = {};\n\n  if( !window.CanvasBgMovie )\n    window.CanvasBgMovie =  Movie;\n\n}() );\n\n\n\n// WEBPACK FOOTER //\n// ./js/App.js","\nclass Movie{\n\tconstructor( $parent, options ) {\n\n\t\tthis.$parent = $parent;\n\n\t\tthis.options = {\n\t\t\tframesPerSecond: 25,\n\t\t\thideVideo: true,\n\t\t\tautoplay: true,\n\t\t\tloop: true,\n\t\t\tfixedTop: false,\n\t\t\tmovieWidth: 960,\n\t\t\tmovieHeight: 540,\n\t\t\tmovieUrl : '',\n\t\t\tposter: '',\n\t\t\tendedCallback: ''\n\t\t}\n\n\t\tjQuery.extend( true, this.options, options );\n\n\t  this.videoNode = jQuery( this.tmplVideo() );\n\t  this.canvasNode = jQuery( this.tmplCanvas() );\n\n\t\tthis.$parent.append( this.videoNode );\n\t\tthis.video = this.videoNode.get( 0 );\n\n\t\tthis.$parent.append( this.canvasNode );\n\t\tthis.canvas = this.canvasNode.get( 0 );\n\n\t\tthis.ctx = this.canvas.getContext( '2d' );\n\n\t\tthis.playing = false;\n\t\tthis.resizeTimeoutReference = false;\n\t\tthis.resizeTimout = 100;\n\n\t\tthis.init();\n\t\tthis.bind();\n\n\t\tif( !this.isIOS() ){\n\t\t\tthis.canvasNode.hide();\n\t\t}\n\t}\n\n\tisIOS() {\n\t\treturn /iPad|iPhone|iPod/.test( navigator.platform );\n\t}\n\n\tposition() {\n\t\tlet movieWidth = this.width;\n\t\tlet movieHeight = this.height;\n\t\tlet winWidth = jQuery( window ).width();\n\t\tlet winHeight = jQuery( window ).height();\n\n\t\tlet left =  -( movieWidth - winWidth ) / 2;\n\t\tlet top = -( movieHeight - winHeight )  / 2;\n\n\t\tif( this.options.fixedTop ) {\n\t\t\ttop = 0;\n\t\t}\n\n\t\tif( this.isIOS() ){\n\t\t\tthis.canvasNode.css({position:'absolute', left: left, top: top});\n\t\t}else{\n\t\t\tthis.videoNode.css({position:'absolute', left: left, top: top});\n\t\t}\n\t}\n\n\tload() {\n\t\tthis.video.load();\n\t}\n\n\tsetLoop( bool ) {\n\t\t( bool )?\n\t\t\tthis.videoNode.prop( 'loop', 'true' ):\n\t\t\tthis.videoNode.prop( 'loop', null );\n\n\t}\n\n\tchangeMovie( movieUrl ) {\n\t\tif( !movieUrl ) return;\n\n\t\tthis.options.movieUrl = movieUrl;\n\t\tthis.videoNode.find( 'source' ).attr( 'src', movieUrl );\n\t}\n\n\tinit() {\n\t\tthis.video.load();\n\t\tthis.setCanvasSize();\n\t\tthis.position();\n\n\t\tif ( this.isIOS() && this.options.hideVideo )\n\t\t\tthis.videoNode.hide();\n\t}\n\n\tbind() {\n\t\tif( this.isIOS() ){\n\t\t\tthis.video.addEventListener('timeupdate', () => {\n\t\t\t\tthis.drawFrame();\n\t\t\t});\n\n\t\t\tthis.video.addEventListener('canplay', () => {\n\t\t\t\tthis.drawFrame();\n\t\t\t});\n\n\t\t\tif (this.video.readyState >= 2) {\n\t\t\t\tthis.drawFrame();\n\t\t\t}\n\t\t}\n\n\t\tthis.video.addEventListener( 'ended', () => {\n\t\t\tthis.options.endCallback && this.options.endCallback();\n\t\t});\n\n\t\tif ( this.isIOS() && this.options.autoplay ) {\n\t\t  this.play();\n\t\t}\n\n\t\t// Cache canvas size on resize (doing it only once in a second)\n\t\tjQuery( window ).on('resize', () => {\n\t\t\t//clearTimeout( this.resizeTimeoutReference );\n\n\t\t\t//this.resizeTimeoutReference = setTimeout(() => {\n\t\t\t\tthis.setCanvasSize();\n\t\t\t\tthis.position();\n\n\t\t\t\tif( this.isIOS() ) this.drawFrame();\n\t\t\t//}, this.resizeTimout );\n\t\t});\n\n\t\tjQuery( document ).bind( 'webkitvisibilitychange', function(){\n\n\t\t\tif ( !window._checkVisibilityChange ) return;\n\n\t\t\tif ( document[ 'webkitHidden' ] ) {\n\t\t\t\tthis.pause();\n\t\t\t} else {\n\t\t\t\tthis.play();\n\t\t\t}\n\t\t});\n\t}\n\n\tsetCanvasSize() {\n\t\tlet movieWidth = this.options.movieWidth;\n\t\tlet movieHeight = this.options.movieHeight;\n\t\tlet winWidth = jQuery( window ).width();\n\t\tlet winHeight = jQuery( window ).height();\n\n\t\tthis.height = Math.ceil( winHeight );\n\t\tthis.width = Math.ceil( this.height * movieWidth / movieHeight );\n\n\t\tif( this.width < winWidth ){\n\t\t\tthis.height = Math.ceil( winHeight + ( ( winWidth - this.width ) * 9 / 16 ) );\n\t\t\tthis.width = Math.ceil( this.height * movieWidth / movieHeight );\n\t\t}\n\n\t\tif( this.isIOS() ){\n\t\t\tthis.ctx.canvas.width = this.width;\n\t\t\tthis.ctx.canvas.height = this.height;\n\n\t\t\tthis.canvasNode.attr('width', this.width);\n\t\t\tthis.canvasNode.attr('height', this.height);\n\t\t}else{\n\t\t\tthis.videoNode.width( this.width );\n\t\t\tthis.videoNode.height( this.height );\n\t\t}\n\t}\n\n\tplay () {\n\t\tif( this.isIOS() ){\n\t\t\tthis.lastTime = Date.now();\n\t\t\tthis.playing = true;\n\t\t\tthis.loop();\n\t\t}else{\n\t\t\tthis.playing = true;\n\n\t\t\t//TODO DOMException: The play() request was interrupted by a call to pause().\n\t\t\ttry {\n\t\t\t\tthis.videoNode.get( 0 ).play();\n\t\t\t} catch( e ){}\n\t\t}\n\t}\n\n\tpause() {\n\t\tif( this.isIOS() ){\n\t\t\tthis.playing = false;\n\t\t}else{\n\t\t\tthis.playing = false;\n\t\t\t//TODO DOMException: The play() request was interrupted by a call to pause().\n\t\t\ttry {\n\t\t\t\tthis.videoNode.get( 0 ).pause();\n\t\t\t} catch( e ){}\n\t\t}\n\t}\n\n\tplayPause() {\n\t\tif (this.playing) {\n\t\t\tthis.pause();\n\t\t} else {\n\t\t\tthis.play();\n\t\t}\n\t}\n\n\tloop () {\n\t\tlet time = Date.now();\n\t\tlet elapsed = ( time - this.lastTime ) / 1000;\n\n\t\t// Render\n\t\tif( elapsed >= (1 / this.options.framesPerSecond ) ) {\n\t\t\tthis.video.currentTime = this.video.currentTime + elapsed;\n\t\t\tthis.lastTime = time;\n\t\t}\n\n\t\tif (this.video.currentTime >= this.video.duration) {\n\t\t\tthis.playing = false;\n\n\t\t\tif (this.options.loop === true) {\n\t\t\t\tthis.video.currentTime = 0;\n\t\t\t\tthis.play();\n\t\t\t}\n\t\t}\n\n\t\tif ( this.playing ) {\n\t\t\tthis.animationFrame = requestAnimationFrame( () => {\n\t\t\t\tthis.loop();\n\t\t\t});\n\t\t}else {\n\t\t\tcancelAnimationFrame( this.animationFrame );\n\t\t}\n\t}\n\n\ttmplVideo () {\n\t\tlet loop = '';\n\n\t\tif( this.options.loop )\n\t\t\tloop = `loop=\"true\" `;\n\n\t\treturn `<video class=\"video\" muted=\"true\" ${loop}autoplay=\"true\" poster=\"${this.options.poster}\">\n\t\t\t<source src=\"${this.options.movieUrl}\" type=\"video/mp4\"></video>`;\n\t}\n\n\ttmplCanvas() {\n\t\treturn '<canvas class=\"canvas\"></canvas>';\n\t}\n\n\tdrawFrame() {\n\t\tthis.ctx.drawImage(this.video, 0, 0, this.width, this.height);\n\t}\n}\n\nmodule.exports = Movie;\n\n\n\n// WEBPACK FOOTER //\n// ./js/Movie.js"],"sourceRoot":""}